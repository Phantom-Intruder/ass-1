-- phpMyAdmin SQL Dump
-- version 4.2.7.1
-- http://www.phpmyadmin.net
--
-- Host: 127.0.0.1
-- Generation Time: Nov 08, 2018 at 02:21 AM
-- Server version: 5.6.20
-- PHP Version: 5.5.15

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;

--
-- Database: `book_db`
--

DELIMITER $$
--
-- Procedures
--
CREATE DEFINER=`root`@`localhost` PROCEDURE `GetBookRecommendations`(IN `userID` VARCHAR(500), IN `bookID` INT(11))
    NO SQL
SELECT * FROM book
WHERE id IN (

    SELECT bookId FROM user_book
    WHERE userId IN(
       
        SELECT userId
        FROM user_book
        WHERE bookId = bookID
        AND userid != userID
    
    )
    
    AND bookid != bookID
)$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `GetBySearchTerm`(IN `searchTerm` VARCHAR(500))
    NO SQL
select * from book where `title` like CONCAT('%',searchTerm,'%') or `author` like CONCAT('%',searchTerm,'%')$$

DELIMITER ;

-- --------------------------------------------------------

--
-- Table structure for table `author`
--

CREATE TABLE IF NOT EXISTS `author` (
`id` int(11) NOT NULL,
  `first_name` varchar(500) NOT NULL,
  `last_name` varchar(500) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;

-- --------------------------------------------------------

--
-- Table structure for table `book`
--

CREATE TABLE IF NOT EXISTS `book` (
`id` int(11) NOT NULL,
  `title` varchar(500) NOT NULL,
  `price` decimal(4,2) NOT NULL,
  `cover` varchar(500) NOT NULL,
  `visitorStats` int(11) NOT NULL,
  `categoryId` int(11) NOT NULL,
  `author` varchar(500) NOT NULL
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=15 ;

--
-- Dumping data for table `book`
--

INSERT INTO `book` (`id`, `title`, `price`, `cover`, `visitorStats`, `categoryId`, `author`) VALUES
(1, 'Thinking, fast and slow', '11.00', 'somewhere', 100, 1, 'Daniel Kahneman'),
(5, 'Red Moon', '8.00', 'https://images.gr-assets.com/books/1520263303l/38496710.jpg', 0, 6, 'Kim Stanley Robinson'),
(8, 'Dare to Lead: Brave Work. Tough Conversations. Whole Hearts', '12.00', '40109367.jpg', 0, 1, 'Bren√© Brown*'),
(11, 'Elevation', '1.00', '383554102.jpg', 0, 3, 'Stephen King'),
(12, 'Almost Everything: Notes on Hope', '13.00', '392037904.jpg', 0, 1, 'Anne Lamott'),
(13, 'The Curse in the Candlelight', '14.22', 's-l225.jpg', 0, 6, 'Sophie Cleverly'),
(14, 'Billion Dollar Whale', '2.75', '38743564.jpg', 0, 5, 'Tom Wright');

-- --------------------------------------------------------

--
-- Table structure for table `cart`
--

CREATE TABLE IF NOT EXISTS `cart` (
  `cartId` int(11) NOT NULL,
  `sessionId` varchar(50) NOT NULL,
  `itemId` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `category`
--

CREATE TABLE IF NOT EXISTS `category` (
`id` int(11) NOT NULL,
  `name` varchar(500) NOT NULL
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=22 ;

--
-- Dumping data for table `category`
--

INSERT INTO `category` (`id`, `name`) VALUES
(5, 'Business'),
(3, 'Horror'),
(21, 'Mystery'),
(2, 'Psychology'),
(6, 'Science Fiction'),
(1, 'Self help');

-- --------------------------------------------------------

--
-- Table structure for table `ci_sessions`
--

CREATE TABLE IF NOT EXISTS `ci_sessions` (
  `id` varchar(40) NOT NULL,
  `ip_address` varchar(45) NOT NULL,
  `timestamp` int(10) unsigned NOT NULL DEFAULT '0',
  `data` blob NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `ci_sessions`
--

INSERT INTO `ci_sessions` (`id`, `ip_address`, `timestamp`, `data`) VALUES
('0u31qedrsrpmaoolh3q0goh9qldos8aa', '::1', 1541583104, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538333130343b75736572497341646d696e7c623a313b),
('2j1d5n8obh1lgc1796vsup1hutaqd72i', '::1', 1541504395, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313530343332373b75736572556e6971756549647c733a31333a2235626531373934643136333931223b75736572436172747c613a323a7b693a303b733a313a2235223b693a313b733a323a223133223b7d),
('57v11av5h4n19optr472uoni5vubj1j9', '::1', 1541582005, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538313839303b75736572497341646d696e7c623a313b),
('5kvabncuhij5b325qhbrggj4c8ali7kd', '::1', 1541512835, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313531323534313b75736572556e6971756549647c733a31333a2235626531386233643432373334223b),
('5n8rp5jhhho1epalmiv8hmqnj78vbvpq', '::1', 1541588288, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538383130343b75736572497341646d696e7c623a313b),
('5nt2s32k6evu64fedgfqkjaonmu7vuhj', '::1', 1541581864, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538313538313b75736572497341646d696e7c623a313b),
('6420tjo5clkdtru6d08vuv0dp241fl4n', '::1', 1541582691, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538323439363b75736572497341646d696e7c623a313b),
('7vb7aol0cackgukhfep5tvdpvv6tl4p0', '::1', 1541582484, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538323435343b),
('8du5353n4pdu1gkv65m8u1o6rap537gg', '::1', 1541514604, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313531343431333b75736572556e6971756549647c733a31333a2235626531373934643136333931223b75736572436172747c613a323a7b693a303b733a313a2235223b693a313b733a323a223133223b7d),
('an6scspbaertrfh3i03vjacgjk3idhja', '::1', 1541586370, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538363132313b75736572497341646d696e7c623a313b),
('apn6iheapc3vpp38vlj0ogbdgosl4tsi', '::1', 1541587589, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538373438303b75736572497341646d696e7c623a313b),
('btv0cp6be5tviqrcidfedm22nqm6u0t5', '::1', 1541506153, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313530353835393b75736572556e6971756549647c733a31333a2235626531373934643136333931223b75736572436172747c613a323a7b693a303b733a313a2235223b693a313b733a323a223133223b7d),
('ckg0rci8l9qt4pf45uac9mdjs3tlik6e', '::1', 1541583343, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538333130393b),
('d46b3t48c69mm23b8rtbk6obijluuukf', '::1', 1541585091, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538343930303b75736572497341646d696e7c623a313b75736572556e6971756549647c733a31333a2235626532623863336239313661223b),
('do95cjkq911a30g1hvhsbt8p7dbl6vbu', '::1', 1541508617, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313530383631303b75736572556e6971756549647c733a31333a2235626531373934643136333931223b75736572436172747c613a323a7b693a303b733a313a2235223b693a313b733a323a223133223b7d),
('dqsoi916lc55oq4o1quuuno8gqic0j81', '::1', 1541588971, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538383931393b75736572497341646d696e7c623a313b75736572556e6971756549647c733a31333a2235626532633661393964653034223b75736572436172747c613a303a7b7d),
('eeuqcm4ni7rnsfep53atmp7fl75g9a3b', '::1', 1541512960, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313531323932333b75736572556e6971756549647c733a31333a2235626531386233643432373334223b),
('flb2mqq75ljubgnpb34s6vmfaladlkue', '::1', 1541513993, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313531333938323b75736572556e6971756549647c733a31333a2235626531373934643136333931223b75736572436172747c613a323a7b693a303b733a313a2235223b693a313b733a323a223133223b7d),
('hfvtmf7lk0nfo334j7rce3s2ngbcm5g9', '::1', 1541513791, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313531333531373b75736572556e6971756549647c733a31333a2235626531373934643136333931223b75736572436172747c613a323a7b693a303b733a313a2235223b693a313b733a323a223133223b7d),
('hq9ggomk6qiqch8s2jo7u4a67h9n1lp6', '::1', 1541582788, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538323737383b75736572497341646d696e7c623a313b),
('ijoorvb3mhp3hhloumths1j8bv1r785u', '::1', 1541503577, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313530333330393b75736572556e6971756549647c733a31333a2235626531373934643136333931223b),
('jcqblerh1rqmao8tk6u3a1qlh00emlt8', '::1', 1541503846, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313530333730383b75736572556e6971756549647c733a31333a2235626531373934643136333931223b75736572436172747c613a323a7b693a303b733a313a2235223b693a313b733a323a223133223b7d),
('l3l5j42lf20hknc17q2n2fa10nj129pe', '::1', 1541513997, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313531333737343b75736572556e6971756549647c733a31333a2235626531386233643432373334223b),
('lf14b427c1ru0gr88u7ji6a5rknvtsqq', '::1', 1541513548, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313531333332313b75736572556e6971756549647c733a31333a2235626531386233643432373334223b),
('mhfdttkulfvt4hfedh8onm76irk0d6r2', '::1', 1541582751, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538323733353b75736572497341646d696e7c623a313b),
('nethrcfvccarba5cu5o106e43h3ud69f', '::1', 1541514586, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313531343538353b75736572556e6971756549647c733a31333a2235626531386233643432373334223b),
('o19ak5e3s1pe9mimmnu1omgjd2gksrlj', '::1', 1541582161, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538323031383b),
('olq547qpkjkrabektla1fc6h3jn7hglg', '::1', 1541505296, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313530353230323b75736572556e6971756549647c733a31333a2235626531373934643136333931223b75736572436172747c613a323a7b693a303b733a313a2235223b693a313b733a323a223133223b7d),
('qvphfll8mlbopde7kev6a780mttsqh7j', '::1', 1541508045, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313530373839333b75736572556e6971756549647c733a31333a2235626531386233643432373334223b),
('slembs62o5i0ldltq50jkpdk7t4ldavm', '::1', 1541506426, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313530363136303b75736572556e6971756549647c733a31333a2235626531373934643136333931223b75736572436172747c613a323a7b693a303b733a313a2235223b693a313b733a323a223133223b7d),
('sv5ve919o2ukeuif8jokdetj9i0uv8jt', '::1', 1541580020, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538303032303b),
('t9bai462v8fettov8btf20cghi75o50u', '::1', 1541587830, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538373739353b75736572497341646d696e7c623a313b),
('urp064u4jt03drfmrj3g1d396o16jub8', '::1', 1541504315, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313530343032323b75736572556e6971756549647c733a31333a2235626531373934643136333931223b75736572436172747c613a323a7b693a303b733a313a2235223b693a313b733a323a223133223b7d),
('utavpuqak66v4gqjromfn2ktlur68bcs', '::1', 1541578192, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313537383139323b),
('v0gen3nq7rjpj7nc6avj0e31kclitm8j', '::1', 1541583562, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538333536323b75736572497341646d696e7c623a313b),
('v6bir3fu4i2murmlp4hppd5cod31m2oj', '::1', 1541588685, 0x5f5f63695f6c6173745f726567656e65726174657c693a313534313538383438343b75736572497341646d696e7c623a313b75736572556e6971756549647c733a31333a2235626532633661393964653034223b75736572436172747c613a313a7b693a303b733a323a223133223b7d);

-- --------------------------------------------------------

--
-- Table structure for table `orders`
--

CREATE TABLE IF NOT EXISTS `orders` (
`orderId` int(11) NOT NULL,
  `sessionId` varchar(500) NOT NULL,
  `bookId` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;

-- --------------------------------------------------------

--
-- Table structure for table `user_book`
--

CREATE TABLE IF NOT EXISTS `user_book` (
`id` int(11) NOT NULL,
  `userId` varchar(500) NOT NULL,
  `bookId` int(11) NOT NULL,
  `dateViewed` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=42 ;

--
-- Dumping data for table `user_book`
--

INSERT INTO `user_book` (`id`, `userId`, `bookId`, `dateViewed`) VALUES
(2, '5be1794d16391', 12, '2018-11-06 17:34:02'),
(4, '5be1794d16391', 1, '2018-11-06 17:34:02'),
(10, '5be1794d16391', 13, '2018-11-06 17:43:46'),
(11, '5be18b3d42734', 13, '2018-11-06 18:10:45'),
(12, '5be1794d16391', 8, '2018-11-06 18:20:17'),
(13, '5be18b3d42734', 13, '2018-11-06 19:25:41'),
(14, '5be18b3d42734', 13, '2018-11-06 19:27:30'),
(15, '5be18b3d42734', 13, '2018-11-06 19:29:52'),
(16, '5be18b3d42734', 13, '2018-11-06 19:30:35'),
(17, '5be18b3d42734', 13, '2018-11-06 19:32:03'),
(18, '5be18b3d42734', 13, '2018-11-06 19:32:40'),
(19, '5be18b3d42734', 13, '2018-11-06 19:38:41'),
(20, '5be18b3d42734', 13, '2018-11-06 19:39:17'),
(21, '5be18b3d42734', 13, '2018-11-06 19:40:07'),
(22, '5be18b3d42734', 13, '2018-11-06 19:41:17'),
(23, '5be1794d16391', 11, '2018-11-06 19:42:22'),
(24, '5be18b3d42734', 13, '2018-11-06 19:42:28'),
(25, '5be1794d16391', 11, '2018-11-06 19:45:56'),
(26, '5be1794d16391', 5, '2018-11-06 19:46:10'),
(27, '5be1794d16391', 0, '2018-11-06 19:46:10'),
(28, '5be18b3d42734', 13, '2018-11-06 19:46:14'),
(29, '5be18b3d42734', 0, '2018-11-06 19:46:14'),
(30, '5be1794d16391', 14, '2018-11-06 19:49:53'),
(31, '5be18b3d42734', 13, '2018-11-06 19:49:57'),
(32, '5be18b3d42734', 0, '2018-11-06 19:49:57'),
(33, '5be1794d16391', 14, '2018-11-06 19:56:53'),
(34, '5be1794d16391', 14, '2018-11-06 19:57:23'),
(35, '5be1794d16391', 14, '2018-11-06 19:57:32'),
(36, '5be1794d16391', 14, '2018-11-06 19:58:54'),
(37, '5be18b3d42734', 1, '2018-11-06 19:59:45'),
(38, '5be18b3d42734', 0, '2018-11-06 19:59:46'),
(39, '5be1794d16391', 1, '2018-11-06 20:00:04'),
(40, '5be2b8c3b916a', 12, '2018-11-07 15:34:51'),
(41, '5be2b8c3b916a', 0, '2018-11-07 15:34:51');

--
-- Indexes for dumped tables
--

--
-- Indexes for table `author`
--
ALTER TABLE `author`
 ADD PRIMARY KEY (`id`);

--
-- Indexes for table `book`
--
ALTER TABLE `book`
 ADD PRIMARY KEY (`id`);

--
-- Indexes for table `category`
--
ALTER TABLE `category`
 ADD PRIMARY KEY (`id`), ADD UNIQUE KEY `name` (`name`);

--
-- Indexes for table `ci_sessions`
--
ALTER TABLE `ci_sessions`
 ADD PRIMARY KEY (`id`), ADD KEY `ci_sessions_timestamp` (`timestamp`);

--
-- Indexes for table `orders`
--
ALTER TABLE `orders`
 ADD PRIMARY KEY (`orderId`);

--
-- Indexes for table `user_book`
--
ALTER TABLE `user_book`
 ADD PRIMARY KEY (`id`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `author`
--
ALTER TABLE `author`
MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;
--
-- AUTO_INCREMENT for table `book`
--
ALTER TABLE `book`
MODIFY `id` int(11) NOT NULL AUTO_INCREMENT,AUTO_INCREMENT=15;
--
-- AUTO_INCREMENT for table `category`
--
ALTER TABLE `category`
MODIFY `id` int(11) NOT NULL AUTO_INCREMENT,AUTO_INCREMENT=22;
--
-- AUTO_INCREMENT for table `orders`
--
ALTER TABLE `orders`
MODIFY `orderId` int(11) NOT NULL AUTO_INCREMENT;
--
-- AUTO_INCREMENT for table `user_book`
--
ALTER TABLE `user_book`
MODIFY `id` int(11) NOT NULL AUTO_INCREMENT,AUTO_INCREMENT=42;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
